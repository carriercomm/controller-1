{"version":3,"sources":["jsonrpc.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oCAgBuB,wBAAwB;;;;IAEzC,OAAO;cAAP,OAAO;;;;AAEE,aAFT,OAAO,CAEG,MAAM,EAAE;8BAFlB,OAAO;;AAGL,mCAHF,OAAO,6CAGC,MAAM,EAAE;AACd,aAAK,IAAI,GAAG,IAAI,MAAM,EAAE;AACpB,gBAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;SAC3B;AACD,YAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACxB;;;;iBARC,OAAO;;eAUL,cAAC,MAAM,EAAE,OAAO,EAAE;AAClB,gBAAI,CAAC,OAAO,EAAE;AACV,uBAAO,GAAG,EAAE,CAAA;aACf;AACD,gBAAI,CAAC,OAAO,CAAC,EAAE,EAAE;AACb,uBAAO,CAAC,EAAE,GAAG,CAAC,CAAC;aAClB;AACD,gBAAI,CAAC,OAAO,CAAC,MAAM,EAAE;AACjB,uBAAO,CAAC,MAAM,GAAG,EAAE,CAAC;aACvB;AACD,gBAAI,OAAO,GAAG;AACV,kBAAE,EAAE,OAAO,CAAC,EAAE;AACd,uBAAO,EAAE,IAAI,CAAC,OAAO;AACrB,sBAAM,EAAE,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,GAAG,EAAE;AAC5C,sBAAM,EAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,MAAM,GAAG,MAAM;aAClE,CAAA;AACD,mBAAO,kCAAW,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAC5B,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC,CACvC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAC7B,IAAI,CAAC,UAAS,GAAG,EAAE;AAChB,oBAAI,CAAC,GAAG,CAAC,IAAI,EACT,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAA;AACvD,uBAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,CAAA;aACrC,EAAE,UAAS,KAAK,EAAE;AACf,oBAAI,KAAK,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,IAAI,EAC3B,MAAM,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAA;AAC1C,sBAAM,KAAK,CAAA;aACd,CAAC,CAAA;SACb;;;WAtCC,OAAO;;;qBAyCE,OAAO","file":"jsonrpc.js","sourcesContent":["/*\n * Isomorphic Javascript library for Minio Controller API, (C) 2015 Minio, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport SuperAgent from 'superagent-es6-promise';\n\nclass JSONrpc extends SuperAgent {\n    // new JSONrpc({endpoint: '...', namespace: '...'})\n    constructor(params) {\n        super(params);\n        for (var key in params) {\n            this[key] = params[key];\n        }\n        this.version = '2.0';\n    }\n    // call('Get', {id: NN, params: [...]}, function() {})\n    call(method, options) {\n        if (!options) {\n            options = {}\n        }\n        if (!options.id) {\n            options.id = 1;\n        }\n        if (!options.params) {\n            options.params = [];\n        }\n        var dataObj = {\n            id: options.id,\n            jsonrpc: this.version,\n            params: options.params ? options.params : [],\n            method: this.namespace ? this.namespace + '.' + method : method\n        }\n        return SuperAgent.post(this.endpoint)\n                .set('Content-Type', 'application/json')\n                .send(JSON.stringify(dataObj))\n                .then(function(res) {\n                    if (!res.text)\n                        throw new Error(\"res.text not set in the response\")\n                    return JSON.parse(res.text).result\n                }, function(error) {\n                    if (error.res && error.res.text)\n                        throw JSON.parse(error.res.text).error\n                    throw error\n                })\n    }\n}\n\nexport default JSONrpc;\n"],"sourceRoot":"/source/"}